I"ğ:<p>å¥½æ— èŠ~ï¼Œæ€»ç»“ä¸€ä¸‹ webpack å¸¸ç”¨çš„é…ç½®å§~</p>

<hr />

<h2 id="context-ç¼–è¯‘çš„ä¸Šä¸‹æ–‡">context [ç¼–è¯‘çš„ä¸Šä¸‹æ–‡]</h2>

<p>åŸºç¡€ç›®å½•ï¼Œç»å¯¹è·¯å¾„ï¼Œç”¨äºä»é…ç½®ä¸­è§£æ <code class="highlighter-rouge">entry</code> å’Œ <code class="highlighter-rouge">loader</code>ï¼Œé»˜è®¤æ˜¯å½“å‰ç›®å½•ï¼Œä¸€èˆ¬çš„é¡¹ç›®å¾ˆå°‘ä¼šæ”¹è¿™ä¸ªé…ç½®~</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="p">{</span>
  <span class="nl">context</span><span class="p">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">"</span><span class="s2">app</span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<h2 id="entry-åº”ç”¨æ‰“åŒ…çš„å…¥å£">entry [åº”ç”¨æ‰“åŒ…çš„å…¥å£]</h2>

<p>ä»¥æ‰“åŒ…ç½‘é¡µä¸ºä¾‹ï¼Œä¸€ä¸ª html ä¸€ä¸ª<code class="highlighter-rouge">entry</code>~ï¼Œå¤šä¸ª html å°±å¤šä¸ª<code class="highlighter-rouge">entry</code></p>

<p>å¤šä¸ª<code class="highlighter-rouge">entry</code>çš„æ —å­ï¼š</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="p">{</span>
    <span class="nl">entry</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">home</span><span class="p">:</span> <span class="dl">'</span><span class="s1">./home.js</span><span class="dl">'</span><span class="p">,</span>
        <span class="nx">about</span><span class="p">:</span> <span class="dl">'</span><span class="s1">./about.js</span><span class="dl">'</span><span class="p">,</span>
        <span class="nx">contact</span><span class="p">:</span> <span class="dl">'</span><span class="s1">./contact.js</span><span class="dl">'</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="output-è¾“å‡ºæ–‡ä»¶">output [è¾“å‡ºæ–‡ä»¶]</h2>

<p>æ —å­</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="p">{</span>
    <span class="nl">output</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">path</span><span class="p">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">'</span><span class="s1">dist</span><span class="dl">'</span><span class="p">),</span>
        <span class="nx">filename</span><span class="p">:</span> <span class="dl">'</span><span class="s1">[name].[chunkhash].bundle.js</span><span class="dl">'</span><span class="p">,</span>
        <span class="nx">publicPath</span><span class="p">:</span> <span class="dl">'</span><span class="s1">https://qn.com/haha/</span><span class="dl">'</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="outputpath">output.path</h4>

<p>è®¾ç½®è¾“å‡ºæ–‡ä»¶çš„ç›®å½•ï¼Œä½¿ç”¨ç»å¯¹è·¯å¾„</p>

<h4 id="outputfilename">output.filename</h4>

<p>è®¾ç½®è¾“å‡ºæ–‡ä»¶çš„æ–‡ä»¶å</p>

<h4 id="outputpublicpath">output.publicPath</h4>

<p>è®¾ç½®é¡¹ç›®ä¸­æ‰€æœ‰èµ„æºï¼ˆjsã€cssã€å›¾ç‰‡ç­‰ï¼‰çš„åŸºç¡€è·¯å¾„</p>

<hr />

<h2 id="resolve-è§£ææ¨¡å—">resolve [è§£ææ¨¡å—]</h2>

<blockquote>
  <p>é…ç½®æ¨¡å—å¦‚ä½•è§£æã€‚ä¸»è¦å°±æ˜¯å½±å“ <code class="highlighter-rouge">import 'some library'</code> ç­‰æ“ä½œ</p>
</blockquote>

<h4 id="resolvealias">resolve.alias</h4>

<p>åˆ›å»º import æˆ– require çš„åˆ«åï¼Œæ¥ç¡®ä¿æ¨¡å—å¼•å…¥å˜å¾—æ›´ç®€å•ã€‚
å¼•ç”¨è·¯å¾„å¯ä»¥ä½¿ç”¨å˜é‡ï¼ˆå¦‚ç¯å¢ƒå˜é‡ï¼‰ï¼Œä»è€Œå®ç°ï¼ŒåŒä¸€ä¸ª<code class="highlighter-rouge">import</code>ï¼Œåœ¨ä¸åŒç¯å¢ƒä¸‹å¼•å…¥ä¸åŒçš„æ¨¡å—ã€‚</p>

<p>æ —å­ï¼š</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="p">{</span>
  <span class="nl">resolve</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">alias</span><span class="p">:</span> <span class="p">{</span>
      <span class="nl">config</span><span class="p">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s2">`src/config/</span><span class="p">${</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">APP_ENV</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>åœ¨ typescript ä¸­ï¼Œç›¸å½“äºé…ç½® tsconfig.json ä¸­çš„ pathï¼š</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="p">{</span>
    <span class="nl">compilerOptions</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">paths</span><span class="p">:</span>  <span class="p">{</span>
            <span class="dl">"</span><span class="s2">@/*</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">src/*</span><span class="dl">"</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h4 id="resolvealiasfields">resolve.aliasFields</h4>

<p>æŒ‡å®šä¸€ä¸ªå­—æ®µï¼Œä¾‹å¦‚ browserï¼Œå¦‚æœå¼•å…¥çš„æ¨¡å—çš„ package.json å†…åŒ…å« browser å­—æ®µï¼Œé‚£ä¹ˆæ‰“åŒ…æ—¶ä¼šä½¿ç”¨è¯¥ browser å­—æ®µçš„å€¼ä½œä¸ºè¯¥æ¨¡å—çš„åˆ«åã€‚</p>

<h4 id="resolveextensions">resolve.extensions</h4>

<p>â€è‡ªåŠ¨è§£ææŒ‡å®šçš„æ‰©å±•â€œã€‚
é»˜è®¤å€¼æ˜¯<code class="highlighter-rouge">['.wasm', '.mjs', '.js', '.json']</code>ï¼Œæ²¡æœ‰åŒ…å«<code class="highlighter-rouge">.ts</code>ï¼Œæ‰€ä»¥æƒ³è¦å¼•å…¥ typescript æ–‡ä»¶ï¼Œéœ€è¦åŠ ä¸Š<code class="highlighter-rouge">.ts</code>~</p>

<h4 id="resolvesymlinks">resolve.symlinks</h4>

<p>æ˜¯å¦ä½¿ç”¨è½¯é“¾æ¥å¯»æ‰¾æ¨¡å—ã€‚å½±å“ <code class="highlighter-rouge">npm link</code> ç­‰æ“ä½œã€‚</p>

<hr />

<h2 id="module-å¤„ç†æ¨¡å—">module [å¤„ç†æ¨¡å—]</h2>

<blockquote>
  <p>é…ç½®å¦‚ä½•å¤„ç†ä¸åŒç±»å‹çš„æ¨¡å—</p>
</blockquote>

<h4 id="modulenoparse">module.noParse</h4>

<p>webpack è§£ææ—¶ï¼Œå¿½ç•¥æŒ‡å®šçš„æ¨¡å—ã€‚
å¦‚æœä½ èƒ½ç¡®å®šä¸€ä¸ªæ¨¡å—ï¼ˆå¦‚ jqueryï¼‰æ²¡æœ‰å¼•ç”¨å…¶ä»–åº“ï¼Œåˆ™å¯ä»¥å¿½ç•¥è¯¥æ¨¡å—ï¼Œæé«˜æ„å»ºæ€§èƒ½~</p>

<h4 id="modulerules">module.rules</h4>

<p>é…ç½®è§„åˆ™æ•°ç»„ï¼Œå®ç°ä½¿ç”¨ä¸åŒçš„ loader å¤„ç†ä¸åŒç±»å‹çš„æ¨¡å—
ä¸€ä¸ªæ¯”è¾ƒä¸°æ»¡çš„æ —å­</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
</pre></td><td class="rouge-code"><pre><span class="p">{</span>
    <span class="nl">module</span><span class="p">:</span> <span class="p">{</span>
        <span class="nl">rules</span><span class="p">:</span> <span class="p">{</span>
            <span class="p">{</span>
                <span class="nl">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\.</span><span class="sr">sass$/</span><span class="p">,</span>
                <span class="nx">oneOf</span><span class="p">:</span> <span class="p">[</span> <span class="c1">// å­è§„åˆ™æ•°ç»„ï¼Œåªä½¿ç”¨ç¬¬ä¸€ä¸ªåŒ¹é…åˆ°çš„å­è§„åˆ™ã€‚</span>
                    <span class="p">{</span>
                        <span class="na">resourceQuery</span><span class="p">:</span> <span class="sr">/module/</span><span class="p">,</span>
                        <span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\.</span><span class="sr">module</span><span class="se">\.\w</span><span class="sr">+$/</span><span class="p">,</span>  <span class="c1">// å­è§„åˆ™ä¹Ÿå¯è®¾ç½®å„ç§åŒ¹é…è§„åˆ™</span>
                        <span class="na">use</span><span class="p">:</span> <span class="p">[</span> <span class="c1">// loaderçš„æ‰§è¡Œé¡ºåºæ˜¯ â€™ä¸‹ --&gt; ä¸Šï¼Œ å³ --&gt; å·¦â€˜</span>
                            <span class="p">{</span>
                                <span class="na">loader</span><span class="p">:</span> <span class="dl">'</span><span class="s1">vue-style-loader</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// å°†å¤„ç†å¥½çš„cssä»¥styleæ ‡ç­¾çš„å½¢å¼æ’å…¥åˆ°æ–‡æ¡£ä¸­</span>
                                <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
                                    <span class="na">sourceMap</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
                                    <span class="na">shadowMode</span><span class="p">:</span> <span class="kc">false</span>
                                <span class="p">}</span>
                            <span class="p">},</span>
                            <span class="p">{</span>
                                <span class="na">loader</span><span class="p">:</span> <span class="dl">'</span><span class="s1">css-loader</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// è§£æã€å¤„ç† jsä¸­å¼•å…¥çš„cssæ¨¡å—</span>
                                <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
                                    <span class="na">sourceMap</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
                                    <span class="na">importLoaders</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                                    <span class="na">modules</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
                                    <span class="na">localIdentName</span><span class="p">:</span> <span class="dl">'</span><span class="s1">[name]_[local]_[hash:base64:5]</span><span class="dl">'</span>
                                <span class="p">}</span>
                            <span class="p">},</span>
                            <span class="p">{</span>
                                <span class="na">loader</span><span class="p">:</span> <span class="dl">'</span><span class="s1">postcss-loader</span><span class="dl">'</span><span class="p">,</span>  <span class="c1">// ä½¿ç”¨postcsså¤„ç†css</span>
                                <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
                                    <span class="na">sourceMap</span><span class="p">:</span> <span class="kc">false</span>
                                <span class="p">}</span>
                            <span class="p">},</span>
                            <span class="p">{</span>
                                <span class="na">loader</span><span class="p">:</span> <span class="dl">'</span><span class="s1">sass-loader</span><span class="dl">'</span><span class="p">,</span> <span class="c1">// è§£æã€å¤„ç† jsä¸­å¼•å…¥çš„scssæ¨¡å—</span>
                                <span class="na">options</span><span class="p">:</span> <span class="p">{</span>
                                    <span class="na">sourceMap</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
                                    <span class="na">indentedSyntax</span><span class="p">:</span> <span class="kc">true</span>
                                <span class="p">}</span>
                            <span class="p">}</span>
                        <span class="p">]</span>
                    <span class="p">}</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<hr />

<h2 id="plugin-ä½¿ç”¨æ’ä»¶">plugin [ä½¿ç”¨æ’ä»¶]</h2>

<blockquote>
  <p>ä½¿ç”¨ webpack æ’ä»¶~</p>
</blockquote>

<h4 id="ä¸“æœ‰åè¯">ä¸“æœ‰åè¯ï¼š</h4>

<ul>
  <li>
    <p>compiler: ä»£è¡¨äº†å®Œæ•´çš„ webpack ç¯å¢ƒé…ç½®ã€‚è¿™ä¸ªå¯¹è±¡åœ¨å¯åŠ¨ webpack æ—¶è¢«ä¸€æ¬¡æ€§å»ºç«‹ï¼Œå¹¶é…ç½®å¥½æ‰€æœ‰å¯æ“ä½œçš„è®¾ç½®ï¼ŒåŒ…æ‹¬ optionsï¼Œloader å’Œ pluginã€‚å½“åœ¨ webpack ç¯å¢ƒä¸­åº”ç”¨ä¸€ä¸ªæ’ä»¶æ—¶ï¼Œæ’ä»¶å°†æ”¶åˆ°æ­¤ compiler å¯¹è±¡çš„å¼•ç”¨ã€‚å¯ä»¥ä½¿ç”¨å®ƒæ¥è®¿é—® webpack çš„ä¸»ç¯å¢ƒã€‚</p>
  </li>
  <li>
    <p>compilation: ä»£è¡¨äº†ä¸€æ¬¡èµ„æºç‰ˆæœ¬æ„å»ºã€‚å½“è¿è¡Œ webpack å¼€å‘ç¯å¢ƒä¸­é—´ä»¶æ—¶ï¼Œæ¯å½“æ£€æµ‹åˆ°ä¸€ä¸ªæ–‡ä»¶å˜åŒ–ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ compilationï¼Œä»è€Œç”Ÿæˆä¸€ç»„æ–°çš„ç¼–è¯‘èµ„æºã€‚ä¸€ä¸ª compilation å¯¹è±¡è¡¨ç°äº†å½“å‰çš„æ¨¡å—èµ„æºã€ç¼–è¯‘ç”Ÿæˆèµ„æºã€å˜åŒ–çš„æ–‡ä»¶ã€ä»¥åŠè¢«è·Ÿè¸ªä¾èµ–çš„çŠ¶æ€ä¿¡æ¯ã€‚compilation å¯¹è±¡ä¹Ÿæä¾›äº†å¾ˆå¤šå…³é”®æ—¶æœºçš„å›è°ƒï¼Œä»¥ä¾›æ’ä»¶åšè‡ªå®šä¹‰å¤„ç†æ—¶é€‰æ‹©ä½¿ç”¨ã€‚</p>
  </li>
</ul>

<h4 id="æ’ä»¶æ‰§è¡Œçš„åŸç†">æ’ä»¶æ‰§è¡Œçš„åŸç†ï¼š</h4>

<p>æ’ä»¶å‡½æ•°çš„ prototype ä¸Šå®šä¹‰çš„ <code class="highlighter-rouge">apply</code> æ–¹æ³•æ¥æ”¶åˆ°å‚æ•° â€“ <code class="highlighter-rouge">compiler</code> å¯¹è±¡ï¼Œ <code class="highlighter-rouge">compiler.plugin('hook', callback)</code> å°†æˆ‘ä»¬çš„å®šä¹‰çš„å‡½æ•° <code class="highlighter-rouge">callback</code> ç»‘å®šåˆ° webpack è‡ªèº«çš„äº‹ä»¶é’©å­ <code class="highlighter-rouge">hook</code> ä¸Šã€‚å…¶ä¸­ï¼Œ<code class="highlighter-rouge">callback</code> å‡½æ•°èƒ½æ¥æ”¶åˆ°å‚æ•° â€“ <code class="highlighter-rouge">compilation</code>ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®<code class="highlighter-rouge">compilation</code>æä¾›çš„æ•°æ®å®ç°æˆ‘ä»¬çš„éœ€æ±‚äº†~</p>

<h4 id="webpack-æä¾›çš„æ‰€æœ‰é’©å­">webpack æä¾›çš„<a href="https://www.webpackjs.com/api/compiler-hooks/">æ‰€æœ‰é’©å­</a></h4>

<hr />

<blockquote>
  <p>æ‚é¡¹ï¼š <a href="https://github.com/Yatoo2018/webpack-chain/tree/zh-cmn-Hans">webpack-chain å°è¯•é€šè¿‡æä¾›å¯é“¾å¼æˆ–é¡ºæµå¼çš„ API åˆ›å»ºå’Œä¿®æ”¹ webpack é…ç½®</a>ï¼›</p>
</blockquote>
:ET